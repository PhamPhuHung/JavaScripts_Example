<!DOCTYPE html>
<html lang="en-US">

<head>
  <title>AJAX Example</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

  <style>
  .table-striped tbody tr:nth-child(odd) {
    background-color: lightgray;
  }
  </style>

  <script>
  $(document).ready(function(){
    $("#get1").click(function(){
      ex1();
    });
  });
function ex1() {
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      document.getElementById("demo").innerHTML =
      this.responseText;
    }
  };
  xhttp.open("GET", "Ex2_1.txt", true);
  xhttp.send();
}
  </script>
</head>
<body>
<div class="container">
  <p>The XMLHttpRequest object is to used to exchange data with a server.</p>
</div>

<div class="container">
  <h2>Send a Request To a Server</h2>
  <p>To send a request to a server, we use the <code>open()</code> and <code>send()</code> methods of the <code>XMLHttpRequest</code> object:</p>
  <p style="background-color:#333; padding: 5px 10px">
    <span style="color:white">xhttp.open(</span>
    <span style="color:green">"GET", "ajax_info.txt", true</span>
    <span style="color:white">);<br>xhttp.send();</span>
  </p>
</div>

<div class="container">
  <h2>XMLHttpRequest Object Methods</h2>
  <table class="table table-responsive table-hover table-bordered">
    <thead><tr>
      <th>Method</th>
      <th>Description</th>
    </tr></thead>

    <tbody>
      <tr>
        <td>open(<i>method, url, async, user, psw)</td>
        <td>Specifies the request<br><br>
            <i style="color:darkgray">method</i>: the request type GET / POST<br>
            <i style="color:darkgray">url</i>: the file location<br>
            <i style="color:darkgray">async</i>: true (asynchronous) / false (synchronous)<br>
            <i style="color:darkgray">user</i>: optional user name<br>
            <i style="color:darkgray">psw</i>: optional password<br>
        </td>
      </tr>

      <tr>
        <td>send()</td>
        <td>Sends the request to the server<br>
            Used for GET requests
        </td>
      </tr>

      <tr>
        <td>send(<i>string</i>)</td>
        <td>Sends the request to the server<br>
            Used for POST requests
        </td>
      </tr>
    </tbody>
  </table>
</div>

<div class="container">
  <h2>GET or POST?</h2>
  <p><code>GET</code> is simpler and faster than <code>POST</code>, and can be used in most cases</p>
  <p>However, always use <code>POST</code> requests when:</p>
  <ul>
    <li>A cached  file is not an option (update a file or database on the server).</li>
    <li>Sending a large amount of data to the server (POST has no size limitations)</li>
    <li>Sending user input (which can contain unknown characters), POST is morre robust and 
  </ul>
</div>

<div class="container">
  <h2>GET Requests</h2>
  <p>A simple <code>GET</code> request:</p>
  <p style="background-color:#333; padding: 5px 10px">
    <span style="color:white">xhttp.open(</span>
    <span style="color:green">"GET", "demo_get.asp", true</span>
    <span style="color:white">);<br>xhttp.send();</span>
  </p>
  <button type="button" class="btn btn-info" id="get1">Send Request</button><p id="get1_p"></p>

  <p>If you want to send information with the <code>GET</code> method, add the information to the URL:</p>
  <p style="background-color:#333; padding: 5px 10px">
    <span style="color:white">xhttp.open(</span>
    <span style="color:green">"GET", "demo_get2.asp?fname=Henry&lname=Ford", true</span>
    <span style="color:white">);<br>xhttp.send();</span>
  </p>
</div>

<div class="container">
  <h2>POST Requests</h2>
  <p>A simple POST Request</p>
  <p style="background-color:#333; padding: 5px 10px">
    <span style="color:white">xhttp.open(</span>
    <span style="color:green">"POST", "demo_get.asp", true</span>
    <span style="color:white">);<br>xhttp.send();</span>
  </p>

  <p>To POST data like an HTML form, add an HTTP header with <code>setRequestHeader()</code>. Specify the data you want to send in the <code>send()</code> method</p>
  <p style="background-color:#333; padding: 5px 10px">
    <span style="color:white">xhttp.open(</span>
    <span style="color:green">"POST", "demo_get.asp", true</span>
    <span style="color:white">);<br>xhttp.setRequestHeader(</span>  
    <span style="color:green">"Content-type", "application/x-www-form-urlencoded"</span>
    <span style="color:white">);<br>xhttp.send();</span>  
  </p>

  <table class="table table-responsive table-hover table-bordered">
    <thead><tr>
      <th>Method</th>
      <th>Description</th>
    </tr></thead>

    <tbody>
      <tr>
        <td>setRequestHeader(<i>header</i>, <i>value</i>)</td>
        <td>Adds HTTP headers to the request<br><br>
            <i>header</i>: specifies the header name<br>
            <i>value</i>: specifies the header value<br>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<div class="container">
  <h2>The url - A File On a Server</h2>
  <p>The url parameter of the <code>open()</code> method, is an address to a file on a server:</p>
  <p style="background-color:#333; padding: 5px 10px">
    <span style="color:white">xhttp.open(</span>
    <span style="color:green">"GET", "ajax_test.asp", true</span>
    <span style="color:white">);</span>  
  </p>
  <p>The file can be any kind of file, like .txt and .xml, or server scripting files like .asp and .php (which can perform actions on the server before sending the response back).</p>
</div>

<div class="container">
  <h2>Asynchronous - True or False</h2>
  <p>Server requests shoudl be sent asynchronously.</p>
  <p>The async parameter of the <code>open</code> method should be set to true:</p>
  <p style="background-color:#333; padding: 5px 10px">
    <span style="color:white">xhttp.open(</span>
    <span style="color:green">"GET", "ajax_test.asp", true</span>
    <span style="color:white">);</span>  
  </p>
  <p>By sending asynchronously, the JavaScript does not have to wait for the servr reponse, but can instead:</p>
  <ul>
    <li>execute other scripts while waiting for server response</li>
    <li>deal wiht the response after the response is ready</li>
  </ul>
</div>

<div class="container">
  <h2>The onreadystatechange Property</h2>
  <p>With the <code>XMLHttpRequest</code> object you can define a function to ve executed when the request receives an answer.</p>
  <p>The function is defined in the <code>onreadystatechagne</code> property of the <code>XMLHttpRequest</code> object:</p>
  <p style="background-color:#333; padding:5px 10px">
    <span style="color:pink">var /span>
    <span style="color:white">xhttp = </span>
    <span style="color:pink">new </span>
    <span style="color:white">XMLHttpRequest();</span><br><br>

    <span style="color:white">xhttm.onreadystatechange = <span>
    <span style="color:pink"> function</span>
    <span style="color:white">() {</span><br>
    <span style="color:pink">&nbsp&nbspif</span>
    <span style="color:white">(</span>
    <span style="color:pink">this<span>
    <span style="color:white">.readyState == 4 && </span>
    <span style="color:pink">this</span>
    <span style="color:white">.status == 200) {<br>
      &nbsp&nbsp&nbsp&nbspdocument.getElementById(<span style="color:green">"demo"</span>).innerHTML = </span>
    <span style="color:pink">this</span>
    <span style="color:white">.responseText;<br>&nbsp&nbsp}<br>};<br>
      xhttp.open(<span style="color:green">"GET", "ajax_info.txt", true</span>);<br>
      xhttp.send();<br></span>
  </p>
  <p>You will learn more about <code>onreadystatechange</code> in a later chapter</p>  
</div>

<div class="container">
  <h2>Synchronous Request</h2>
  <p>To execute a sunchronous request, change the third parameter in the <code>open()</code> method to <code>false</code>:</p>
  <p style="background-color:#333; padding: 5px 10px">
    <span style="color:white">xhttp.open(</span>
    <span style="color:green">"GET", "ajax_test.asp", false</span>
    <span style="color:white">);</span>  
  </p>
  <p>Sometimes, <code>async = false</code> are used for quick testing. You will also find synchronous requests in older JavaScript code.</p>
  <p>Since the code will wait for server completion, there is no need for an <code>onreadystatechange</code> function:</p>
  <p style="background-color:#333; padding:5px 10px">
    <span style="color:white">
      xhttp.open(<span style="color:green">"GET", "ajax_info.txt", true</span>);<br>
      xhttp.send();<br>
      document.getElementById(<span style="color:green">"demo"</span>).innerHTML = xhttp.responseText;<br>
    </span>
  </p>
  <div style="background-color: lightpink; padding:20px">
    <p>Synchronous XMLHttpRequest (async = false) is not recommended because the JavaScript will stop executing until the server response is ready. If the server is busy or slow, the applicaiton will hang or stop.<p>
    <p>Synchronous XMLHttpRequest is in the process of being remvoed ffrom the web standard, but this process can take many years.</p>
    <p>Modern developer tools ar encouraged to warn about using synchronous requests and may throw an InvalidAccesserror exception when it occurs.</p>
  </div>
</div>

</body>
</html>